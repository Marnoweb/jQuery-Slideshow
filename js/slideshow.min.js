/**
 * @name        jQuery Slideshow
 * @author      Matt Hinchliffe <https://github.com/i-like-robots/jQuery-Slideshow>
 * @modified    09/10/2012
 * @version     1.5.0
 * @example
 * <div class="slideshow">
 *     <ul class="carousel">
 *         <li class="slide"><a href="#">Option 1</a></li>
 *         <li class="slide"><a href="#">Option 2</a></li>
 *     </ul>
 * </div>
 *
 * @example
 * var slideshow = $('.slideshow').slides(opts).eq(0).data('slides');
 */
;(function(e,t){"use strict";var n={carousel:".carousel",items:".slide",slideWidth:!1,jumpQueue:!0,offset:1,skip:!0,pagination:!0,gestures:!0,auto:6e3,autostop:!0,hoverPause:!1,loop:!1,transition:"scroll",speed:600,easing:"swing",visible:1,onupdate:t,oncomplete:t},r=function(t,r){return this.target=t,this.$target=e(t),this.opts=e.extend({},n,r,this.$target.data()),this.$carousel=this.$target.children(this.opts.carousel),this.$items=this.$carousel.children(this.opts.items),this.count=this.$items.length,this.current=this.opts.offset-1,this.count>1&&this._init(),this};r.prototype={_init:function(){var t=this;this.$carousel.wrap('<div style="position:relative;overflow:hidden;" />'),this.$wrapper=this.$carousel.parent(),this.$target.css("position","relative"),this._transitions[this.opts.transition].setup.call(this);if(this.opts.pagination){this.$pagination=e('<ul class="slides-pagination" />');for(var n=0;n<this.count;n++)e('<li class="'+(n===this.current?"selected":"")+'">'+'<a data-slides="'+n+'" href="">'+(n+1)+"</a>"+"</li>").appendTo(this.$pagination);this.$pagination.appendTo(this.$target)}this.opts.skip&&(this.$next=e('<a class="slides-next" data-slides="next" href="">Next</a>').appendTo(this.$target),this.$previous=e('<a class="slides-previous" data-slides="previous" href="">Previous</a>').appendTo(this.$target)),(this.opts.pagination||this.opts.skip)&&this.$target.on("click.slides","[data-slides]",function(n){n.preventDefault();var r=e(this);r.hasClass("disabled")||t.to(r.data("slides"),!0)}),this.opts.gestures&&"ontouchstart"in document.documentElement&&(this.target.addEventListener("touchstart",function(e){t.t={x1:e.touches[0].pageX,el:e.touches[0].target,dif:0}},!1),this.target.addEventListener("touchmove",function(e){t.t.x2=e.touches[0].pageX,t.t.dif=Math.abs(t.t.x1-t.t.x2),t.t.dif>30&&e.preventDefault()},!1),this.target.addEventListener("touchend",function(){t.t.x2>0&&t.t.dif>30&&t.to(t.t.x1-t.t.x2>0?"next":"previous",!0)},!1)),this.to(this.current),this.opts.auto&&(this.opts.hoverPause&&this.$target.hover(function(){t.stopped||t.pause()},function(){t.paused&&t.play()}),this.play())},_update:function(){this.opts.pagination&&this.$pagination.children().removeClass("selected").eq(this.current).addClass("selected"),this.opts.skip&&!this.opts.loop&&(this.hasNext()?this.$next.addClass("disabled"):this.$next.removeClass("disabled"),this.hasPrevious()?this.$previous.addClass("disabled"):this.$previous.removeClass("disabled"))},_transitions:{crossfade:{setup:function(){var e=this;this.$items.css({top:0,left:0}).filter(function(t){return t!==e.current}).css("display","none")},execute:function(e){var t=this.$items.eq(e).css("position","absolute").fadeIn(this.opts.speed,this.opts.easing);this.$items.eq(this.current).fadeOut(this.opts.speed,this.opts.easing,function(){t.css("position","static")},this.opts.oncomplete)},teardown:function(){this.$items.stop(!0,!0).removeAttr("style")}},scroll:{setup:function(){var e=this.$items.css({"float":"left",width:this.opts.slideWidth}).outerWidth(!0);this.$carousel.css("minWidth",e*this.count),this.realcount=this.count,this.count-=this.opts.visible-1},execute:function(e){this.$wrapper.animate({scrollLeft:this.$items.eq(e).position().left+this.$wrapper.scrollLeft()},this.opts.speed,this.opts.easing,this.opts.oncomplete)},teardown:function(){this.count=this.realcount,delete this.realcount,this.$carousel.stop(!0,!0).removeAttr("style"),this.$items.removeAttr("style")}}},hasNext:function(){return this.current===this.count-1},hasPrevious:function(){return this.current===0},next:function(){this.to("next")},previous:function(){this.to("previous")},to:function(e,t){if(this.opts.jumpQueue)this.$items.stop(!0,!0);else if(this.$items.queue("fx").length)return;e==="next"?e=this.current+1:e==="previous"&&(e=this.current-1);if(e>this.count-1){if(!this.opts.loop){this.stop();return}e=0}else if(e<0){if(!this.opts.loop)return;e=this.count-1}t&&!this.stopped&&(this.opts.autostop?this.stop():this.paused||this.play()),e!==this.current&&(this._transitions[this.opts.transition].execute.call(this,e),this.current=e),this._update(),this.opts.onupdate&&this.opts.onupdate.call(this,this.current)},redraw:function(e){this._transitions[this.opts.transition].teardown.call(this),e&&(this.opts.transition=e),this._transitions[this.opts.transition].setup.call(this),this.to(0)},play:function(){var e=this;clearInterval(this.timeout),this.paused=this.stopped=!1,this.timeout=setInterval(function(){e.to(e.current+1)},this.opts.auto)},pause:function(){this.paused=!0,clearInterval(this.timeout)},stop:function(){this.stopped=!0,this.paused=!1,clearInterval(this.timeout)}},e.fn.slides=function(t){return this.each(function(){e.data(this,"slides")||e.data(this,"slides",new r(this,t))})}})(jQuery)