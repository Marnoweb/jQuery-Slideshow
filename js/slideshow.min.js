/**
 * @name        jQuery Slideshow
 * @author      Matt Hinchliffe <https://github.com/i-like-robots/jQuery-Slideshow>
 * @modified    15/11/2012
 * @version     1.5.2
 * @example
 * <div class="slideshow">
 *     <ul class="carousel">
 *         <li class="slide"><a href="#">Option 1</a></li>
 *         <li class="slide"><a href="#">Option 2</a></li>
 *     </ul>
 * </div>
 *
 * @example
 * var slideshow = $('.slideshow').slides(opts).eq(0).data('slides');
 */
(function(a,b){"use strict";var c={carousel:".carousel",items:".slide",slideWidth:!1,jumpQueue:!0,offset:1,skip:!0,pagination:!0,gestures:!0,auto:6e3,autostop:!0,hoverPause:!1,loop:!1,nextText:"Next",previousText:"Previous",transition:"scroll",speed:600,easing:"swing",visible:1,onupdate:b,oncomplete:b},d=function(b,d){return this.target=b,this.$target=a(b),this.opts=a.extend({},c,d,this.$target.data()),this.$carousel=this.$target.children(this.opts.carousel),this.$items=this.$carousel.children(this.opts.items),this.count=this.$items.length,this.current=this.opts.offset-1,this.count>1&&this._init(),this};d.prototype={_init:function(){var b=this,c=a("<div>",{style:"position:relative;overflow:hidden;"});this.$wrapper=this.$carousel.wrap(c).parent(),this.$target.css("position","relative"),this._transitions[this.opts.transition].setup.call(this);if(this.opts.pagination){this.$pagination=a("<ul>",{"class":"slides-pagination"});for(var d=0,e=this.count;d<e;d++){var f=a("<li>",{"class":d===this.current?"selected":""}),g=a("<a>",{"data-slides":d,text:d+1,href:"#"});f.append(g).appendTo(this.$pagination)}this.$target.append(this.$pagination)}this.opts.skip&&(this.$next=a("<a>",{"data-slides":"next","class":"slides-next",text:this.opts.nextText,href:"#"}),this.$previous=a("<a>",{"data-slides":"previous","class":"slides-previous",text:this.opts.previousText,href:"#"}),this.$target.append(this.$next).append(this.$next,this.$previous)),(this.opts.pagination||this.opts.skip)&&this.$target.on("click.slides","[data-slides]",function(c){c.preventDefault();var d=a(this);d.hasClass("disabled")||b.to(d.data("slides"),!0)}),this.opts.gestures&&"ontouchstart"in document.documentElement&&(this.target.addEventListener("touchstart",function(a){b.t={x1:a.touches[0].pageX,el:a.touches[0].target,dif:0}},!1),this.target.addEventListener("touchmove",function(a){b.t.x2=a.touches[0].pageX,b.t.dif=Math.abs(b.t.x1-b.t.x2),b.t.dif>30&&a.preventDefault()},!1),this.target.addEventListener("touchend",function(){b.t.x2>0&&b.t.dif>30&&b.to(b.t.x1-b.t.x2>0?"next":"previous",!0)},!1)),this.to(this.current),this.opts.auto&&(this.opts.hoverPause&&this.$target.hover(function(){b.stopped||b.pause()},function(){b.paused&&b.play()}),this.play())},_update:function(){this.opts.pagination&&this.$pagination.children().removeClass("selected").eq(this.current).addClass("selected"),this.opts.skip&&(!this.hasNext()&&!this.opts.loop?this.$next.addClass("disabled"):this.$next.removeClass("disabled"),!this.hasPrevious()&&!this.opts.loop?this.$previous.addClass("disabled"):this.$previous.removeClass("disabled"))},_transitions:{crossfade:{setup:function(){var a=this;this.$items.css({top:0,left:0}).filter(function(b){return b!==a.current}).css("display","none")},execute:function(a){var b=this.$items.eq(a).css("position","absolute").fadeIn(this.opts.speed,this.opts.easing);this.$items.eq(this.current).fadeOut(this.opts.speed,this.opts.easing,function(){b.css("position","static")},this.opts.oncomplete)},teardown:function(){this.$items.stop(!0,!0).removeAttr("style")}},scroll:{setup:function(){var a=this.$items.css({"float":"left",width:this.opts.slideWidth}).outerWidth(!0);this.$carousel.css("minWidth",a*this.count),this.realcount=this.count,this.count-=this.opts.visible-1},execute:function(a){this.$wrapper.animate({scrollLeft:this.$items.eq(a).position().left+this.$wrapper.scrollLeft()},this.opts.speed,this.opts.easing,this.opts.oncomplete)},teardown:function(){this.count=this.realcount,this.$carousel.stop(!0,!0).removeAttr("style"),this.$items.removeAttr("style")}}},hasNext:function(){return this.current<this.count-1},hasPrevious:function(){return this.current>0},next:function(){this.to("next")},previous:function(){this.to("previous")},to:function(a,b){if(this.opts.jumpQueue)this.$items.stop(!0,!0);else if(this.$items.queue("fx").length)return;a==="next"?a=this.current+1:a==="previous"&&(a=this.current-1),a>=this.count?a=this.opts.loop?0:this.current:a<0&&(a=this.opts.loop?this.count-1:this.current),b&&!this.stopped&&(this.opts.autostop?this.stop():this.paused||this.play()),a!==this.current&&(this._transitions[this.opts.transition].execute.call(this,a),this.current=a),this._update(),this.opts.onupdate&&this.opts.onupdate.call(this,this.current)},redraw:function(a){this._transitions[this.opts.transition].teardown.call(this),a&&(this.opts.transition=a),this._transitions[this.opts.transition].setup.call(this),this.to(0)},play:function(){var a=this;clearInterval(this.timeout),this.paused=this.stopped=!1,this.timeout=setInterval(function(){a.to(a.current+1)},this.opts.auto)},pause:function(){this.paused=!0,clearInterval(this.timeout)},stop:function(){this.stopped=!0,this.paused=!1,clearInterval(this.timeout)}},a.fn.slides=function(b){return this.each(function(){a.data(this,"slides")||a.data(this,"slides",new d(this,b))})}})(jQuery)